<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:workDesign="clr-namespace:WorkDesign"
             x:Class="WorkDesign.DiagnosticPanel"
             Margin="4,0"
             InputTransparent="True">

    <ContentView.Resources>
        <ResourceDictionary>

            <Style x:Key="DiagnosticBorder"
                   TargetType="Border">
                <Setter Property="Padding" Value="8,4" />
                <Setter Property="BackgroundColor" Value="White" />
                <Setter Property="Opacity" Value="0.65" />
                <Setter Property="StrokeShape" Value="RoundRectangle 8" />
                <Setter Property="StrokeThickness" Value="0.5" />
                <Setter Property="Stroke" Value="LightGray" />
                <Setter Property="Shadow">
                    <Shadow Offset="4,4"
                            Brush="Black" Opacity="0.25" Radius="4" />
                </Setter>
            </Style>

            <Style x:Key="DiagnosticValueLabel"
                   TargetType="Label">
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="FontSize" Value="14" />
                <Setter Property="TextColor" Value="Black" />
            </Style>

            <Style x:Key="DiagnosticSeparatorBoxView"
                   TargetType="BoxView">
                <Setter Property="HeightRequest" Value="1" />
                <Setter Property="Margin" Value="0,3" />
                <Setter Property="Color" Value="Gray" />
            </Style>

            <workDesign:AlertLevelToColorConverter x:Key="AlertLevelToColorConverter"
                                                   CriticalColor="{StaticResource RedDarken3}"
                                                   SafeColor="{StaticResource GreenDarken3}"
                                                   WarningColor="{StaticResource OrangeDarken3}" />

        </ResourceDictionary>
    </ContentView.Resources>

    <ContentView.BindingContext>
        <workDesign:DiagnosticPanelViewModel />
    </ContentView.BindingContext>

    <Border Style="{StaticResource DiagnosticBorder}">

        <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto"
              ColumnDefinitions="Auto,3,Auto">

            <Label Grid.Row="0" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="FPS:" />
            <Label Grid.Row="0" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding FpsValue, StringFormat='{0:F1}'}"
                   TextColor="{Binding FpsAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <Label Grid.Row="1" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="FrameTime:" />
            <Label Grid.Row="1" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding FrameValue, StringFormat='{0:F1}ms'}"
                   TextColor="{Binding FrameAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <BoxView Grid.Row="2" Grid.ColumnSpan="3"
                     Style="{StaticResource DiagnosticSeparatorBoxView}" />

            <Label Grid.Row="3" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="CPU:" />
            <Label Grid.Row="3" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding CpuValue, StringFormat='{0:F1}%'}"
                   TextColor="{Binding CpuAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <Label Grid.Row="4" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="Threads:" />
            <Label Grid.Row="4" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding ThreadsValue}"
                   TextColor="{Binding ThreadsAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <BoxView Grid.Row="5" Grid.ColumnSpan="3"
                     Style="{StaticResource DiagnosticSeparatorBoxView}" />

            <Label Grid.Row="6" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="Memory:" />
            <Label Grid.Row="6" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding MemoryValue, StringFormat='{0:F1}MB'}"
                   TextColor="{Binding MemoryAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <Label Grid.Row="7" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="GC0:" />
            <Label Grid.Row="7" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding Gc0Value}"
                   TextColor="{Binding GcAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <Label Grid.Row="8" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="GC1:" />
            <Label Grid.Row="8" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding Gc1Value}"
                   TextColor="{Binding GcAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <Label Grid.Row="9" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="GC2:" />
            <Label Grid.Row="9" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding Gc2Value}"
                   TextColor="{Binding GcAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <Label Grid.Row="10" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="Alloc/sec:" />
            <Label Grid.Row="10" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding AllocValue, StringFormat='{0:F1}MB'}"
                   TextColor="{Binding AllocAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

            <BoxView Grid.Row="11" Grid.ColumnSpan="3"
                     Style="{StaticResource DiagnosticSeparatorBoxView}" />

            <Label Grid.Row="12" Grid.Column="0"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="Battery:" />
            <Label Grid.Row="12" Grid.Column="2"
                   Style="{StaticResource DiagnosticValueLabel}"
                   Text="{Binding BatteryValue, StringFormat='{0}mW'}"
                   TextColor="{Binding BatteryAlert, Converter={StaticResource AlertLevelToColorConverter}}" />

        </Grid>

    </Border>

</ContentView>
